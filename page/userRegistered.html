<!DOCTYPE html>
<html lang="en" xmlns:v-on="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="UTF-8">
    <title>用户注册</title>
</head>
<link rel="stylesheet" href="../styles/common.css">
<link rel="stylesheet" href="../styles/index.css">
<link rel="stylesheet" href="../styles/csslunbo.css">
<link rel="stylesheet" href="../styles/bootstrap.css">

<body>
    <div id="login">
        <div class="title">
            <div class="indexTitle">
                <span>室内空气品质的智能诊断系统</span>
            </div>
            <div class="right" id="username">
                <div class="row">
                    <div class="col-xs-12 col-sm-6 col-md-8">
                        <img src="../images/user.jpg" alt="">
                        <span id="realUser">admin</span> <span class="fontSpan">欢迎您！</span>
                    </div>
                    <div class="col-xs-6 col-md-4 exit">
                        <button class="btn btn-primary" onclick="cancelExit()" value="注销退出">注销退出</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="top">
            <div class="slideshow">
                <div class="swiper-container" style="width: 100%;height: 500px;">
                    <div class="swiper-wrapper">
                        <div class="swiper-slide"><img src="../images/z-1.jpg" height="500" width="1024" />
                        </div>
                        <div class="swiper-slide"><img src="../images/z_2.jpg" height="500" width="1024" />
                        </div>
                        <div class="swiper-slide"><img src="../images/z_3.jpg" height="500" width="1024" />
                        </div>
                        <div class="swiper-slide"><img src="../images/z_4.jpg" height="500" width="1024" />
                        </div>
                        <div class="swiper-slide"><img src="../images/z_5.jpg" height="500" width="1024" />
                        </div>
                    </div>
                    <div class="swiper-pagination"></div>
                </div>
            </div>
        </div>
        <div class="heng"></div>

        <div class="content clearfix">
            <div class="leftHuan">
                <div class="listHuan">
                    <div class="listTop">
                        <div class="text">
                            <img src="../images/syz.jpg" alt="">
                            <a href="userLogin.html" class="btn btn-info" style="width: 50px;height: 20px;line-height: 20px;">返回</a>
                            <span>用户注册</span>
                        </div>
                    </div>
                    <div class="listBottom clearfix">
                        <table class="rightPartContent" width="100%" cellpadding="0" cellspacing="0" border="0" align="center">
                            <tr>
                                <td class="bond">用户ID：</td>
                                <td style="text-align: left;padding: 0 3%;">
                                    <input class="haun" v-on:blur="userId" v-model="userIdValue" type="number">
                                    <span>{{errorUserID}}</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="bond">登录名：</td>
                                <td style="text-align: left;padding: 0 3%;">
                                    <input class="haun" v-on:blur="userLogin" v-model="userLoginValue" type="text">
                                    <span>{{errorUserLogin}}</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="bond">真实姓名：</td>
                                <td style="text-align: left;padding: 0 3%;">
                                    <input class="haun" v-on:blur="patUser" v-model="patientName" type="text">
                                    <span>{{errorUser}}</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="bond">密码：</td>
                                <td style="text-align: left;padding: 0 3%;">
                                    <input class="haun" v-on:blur="Pass" v-model="patientPass" type="password">
                                    <span>{{errorPass}}</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="bond">电话：</td>
                                <td style="text-align: left;padding: 0 3%;">
                                    <input class="haun" v-on:blur="patPhone" v-model="patientPhone" type="tel">
                                    <span>{{errorPhone}}</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="bond">邮箱：</td>
                                <td style="text-align: left;padding: 0 3%;">
                                    <input class="haun" v-on:blur="patPost" v-model="patientPost" type="email">
                                    <span>{{errorPost}}</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="bond"></td>
                                <td style="padding: 9px 0;">
                                    <input class="btn btn-success R" @click="patientConfirm" type="button" value="确定">
                                    <input class="btn btn-primary R" @click="patientReset" type="button" value="重置">
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="font">
            <p>学号：1403110104</p>
            <p>版权所有&copy;西安科技大学计算机学院</p>
            <p>地址：西安市临潼区陕鼓大道48号</p>
        </div>
    </div>


    <script type="text/javascript" src="../script/vue.js"></script>
    <script type="text/javascript" src="../script/jquery.js"></script>
    <script type="text/javascript" src="../script/lunBo1.js"></script>
    <script type="text/javascript">
        new Vue({
            el: '#login',
            data() {
                return {
                    patientPass: '',
                    patientName: '',
                    patientPhone: "",
                    patientPost: "",
                    userIdValue: "",
                    userLoginValue: "",

                    errorPass: '',
                    errorUser: '',
                    errorPhone: "",
                    errorPost: "",
                    errorUserID: "",
                    errorUserLogin: ""
                }
            },
            methods: {
                patUser() {
                    if (this.patientName) {
                        this.errorUser = "";
                    } else {
                        this.errorUser = "真实姓名不能为空"
                    }
                },
                userLogin() {
                    if (this.userLoginValue) {
                        this.errorUserLogin = "";
                    } else {
                        this.errorUserLogin = "登录用户名不能为空"
                    }
                },
                userId() {
                    if (this.userIdValue) {
                        this.errorUserID = "";
                    } else {
                        this.errorUserID = "用户ID不能为空"
                    }
                },
                Pass() {
                    if (this.patientPass) {
                        this.errorPass = "";
                    } else {
                        this.errorPass = "密码不能为空"
                    }
                },
                patPhone() {
                    if (this.patientPhone) {
                        this.errorPhone = "";
                        var phone = /^1(3|4|5|7|8)\d{9}$/; //手机号校验
                        if (phone.test(this.patientPhone)) {
                            this.errorPhone = "";
                        } else {
                            this.errorPhone = "电话号码格式不正确"
                        }
                    } else {
                        this.errorPhone = "电话不能为空"
                    }
                },
                patPost() {
                    if (this.patientPost) {
                        this.errorPost = "";
                        var reg = /^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/;
                        if (reg.test(this.patientPost)) {
                            this.errorPost = "";
                        } else {
                            this.errorPost = "邮箱格式不正确";
                        }
                    } else {
                        this.errorPost = "邮箱不能为空"
                    }
                },
                patientConfirm() {
                    this.userId();
                    this.userLogin();
                    this.patUser();
                    this.Pass();
                    this.patPhone();
                    this.patPost();
                    var registerData = {
                        userId: this.userIdValue,
                        username: this.userLoginValue,
                        realName: this.patientName,
                        password: this.patientPass,
                        mobile: this.patientPhone,
                        email: this.patientPost,
                    };
                    registerData = JSON.stringify(registerData);
                    $.ajax({
                        type: "POST",
                        url: 'http://localhost:8888/users',
                        data: registerData,
                        dataType: "json",
                        async: false,
                        contentType: "application/json",
                        success: function(result) {
                            if (result.code === 0) { //注册成功
                                alert(result.msg);
                                parent.location.href = './userLogin.html'
                            }
                        },
                        error: function() {
                            alert("请求失败！");
                        }
                    });
                },
                patientReset() {
                    this.patientPass = "",
                        this.patientName = "",
                        this.patientPhone = "",
                        this.patientPost = "",
                        this.userIdValue = "",
                        this.userLoginValue = ""
                },
            }
        })
    </script>
    <script type="text/javascript">
        var mySwiper = new Swiper('.swiper-container', {
            effect: 'fade',
            autoplay: true,
            loop: true,
            pagination: {
                el: '.swiper-pagination',
            },
        })
    </script>
</body>

</html>